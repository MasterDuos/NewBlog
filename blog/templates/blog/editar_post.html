{% extends "base.html" %}

{% block title %}Editar Post - NewBlog{% endblock %}

{% block content %}
  <div class="form-card">
    <h2>âœ Editar post</h2>

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      {{ form.as_p }}

      <!-- ğŸ‘‡ Imagen actual -->
      {% if post.imagen %}
        <div style="margin:1rem 0;">
          <h4>ğŸ“Œ Imagen actual:</h4>
          <img src="{{ post.imagen.url }}" alt="{{ post.titulo }}" style="max-width:100%; border-radius:8px;">
        </div>
      {% endif %}

      <!-- ğŸ‘‡ Vista previa de la nueva imagen -->
      <div id="preview" style="margin-top:1rem; display:none;">
        <h4>ğŸ“· Vista previa (nueva):</h4>
        <img id="preview-img" src="" alt="Vista previa" style="max-width:100%; border-radius:8px; margin-top:0.5rem;">
      </div>

      <button type="submit" class="save">ğŸ’¾ Guardar cambios</button>
    </form>
  </div>

  <!-- Script para vista previa -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const input = document.querySelector('input[type="file"]');
      const previewDiv = document.getElementById("preview");
      const previewImg = document.getElementById("preview-img");

      if (input) {
        input.addEventListener("change", function() {
          const file = this.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
              previewImg.src = e.target.result;
              previewDiv.style.display = "block";
            };
            reader.readAsDataURL(file);
          } else {
            previewDiv.style.display = "none";
          }
        });
      }
    });
  </script>
{% endblock %}
